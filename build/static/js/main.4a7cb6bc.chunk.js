(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{12:function(e,t,n){},13:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),s=n(5),r=n.n(s),o=(n(12),n(13),n(2)),i=n(6),l=n(7),m=n.n(l),u=(n(14),n(0)),j=void 0,f=function(e){var t=Object(c.useState)(!1),n=Object(o.a)(t,2),a=n[0],s=n[1],r=Object(c.useState)(),l=Object(o.a)(r,2),f=l[0],d=l[1],h=Object(c.useState)(),b=Object(o.a)(h,2),O=b[0],p=b[1],v=Object(c.useRef)(),x=Object(c.useRef)(),g=Object(c.useRef)(),N=Object(c.useState)(""),C=Object(o.a)(N,2),y=C[0],w=C[1],S=Object(c.useState)(""),k=Object(o.a)(S,2),M=k[0],P=k[1],F=Object(c.useState)(""),I=Object(o.a)(F,2),E=I[0],L=I[1],J=Object(c.useState)(0),T=Object(o.a)(J,2),_=T[0],D=T[1],R=Object(c.useState)(0),W=Object(o.a)(R,2),A=W[0],B=W[1];function G(){a?f.pause():f.play(),s(!a)}return Object(c.useEffect)((function(){var t=x.current,n=function(e){return e.style.width="100%",e.style.height="5%",e.width=e.offsetWidth,e.height=e.offsetHeight,e.width}(t),c=t.getContext("2d");if(e.timelineComments){var a,s=Object(i.a)(e.timelineComments);try{var r=function(){var e=a.value,t=new Image;t.src=e.avatar,t.alt="",t.className=e.timestamp,t.onload=function(){console.log("load done",t.src),console.log("duration",O);var a=e.timestamp/O*n;c.drawImage(t,a,0)}};for(s.s();!(a=s.n()).done;)r()}catch(o){s.e(o)}finally{s.f()}}})),Object(c.useEffect)((function(){if(v.current){var e=m.a.create({container:v.current,waveColor:"white",progressColor:"#FF8000",barWidth:2,height:400,cursorColor:"transparent",closeAudioContext:!0,responsive:!0});return d(e),e.load("514386__kevin-manickam__relaxation-sound.wav"),e.on("ready",(function(){var t=parseInt(e.getDuration());p(t),e.setVolume(.5)})),function(){return j?j.wavesurfer.current.destroy():null}}}),[]),Object(c.useEffect)((function(){""!==E&&f.on("seek",(function(e){var t=f.getDuration()*e;L(t);var n=Math.floor(t/60);D(n);var c=Math.floor(t%60);B(c)}))})),Object(u.jsxs)("div",{className:"",children:[Object(u.jsxs)("div",{className:"player-panel",children:[Object(u.jsxs)("div",{children:[Object(u.jsxs)("div",{className:"audio-info",children:[Object(u.jsxs)("div",{className:"info",children:[Object(u.jsx)("p",{className:"artist",children:"Kevin Manickam"}),Object(u.jsx)("p",{className:"audio-name",children:"Relaxation Music"})]}),a?Object(u.jsx)("i",{className:"fa fa-pause-circle-o",onClick:G}):Object(u.jsx)("i",{className:"fa fa-play-circle-o",onClick:G})]}),Object(u.jsxs)("div",{className:"canvas-panel",children:[Object(u.jsx)("div",{className:"waveform",ref:v}),Object(u.jsx)("canvas",{className:"canvas",ref:x,width:"50rem",height:"1rem"})]})]}),Object(u.jsx)("div",{className:"audio-image-panel",children:Object(u.jsx)("img",{className:"audio-image",src:"https://i.ytimg.com/vi/6lt2JfJdGSY/maxresdefault.jpg",alt:""})})]}),Object(u.jsx)("p",{className:"timeline-comment",ref:g}),Object(u.jsxs)("div",{className:"add-comment-panel",children:[Object(u.jsx)("input",{type:"text",value:y,onChange:function(e){w(e.target.value)},className:"username",placeholder:"Username"}),Object(u.jsx)("input",{type:"text",value:M,onChange:function(e){if(""===E){var t=f.getCurrentTime();console.log("timestamp",t),L(t);var n=Math.floor(t/60);D(n);var c=Math.floor(t%60);B(c)}P(e.target.value)},className:"comment",placeholder:"Write a comment"}),Object(u.jsx)("span",{children:" at "}),Object(u.jsx)("input",{type:"text",value:_,onChange:function(e){var t=parseInt(e.target.value);D(t),L(60*t+A)},placeholder:"Minute"}),Object(u.jsx)("span",{children:" : "}),Object(u.jsx)("input",{type:"text",value:A,onChange:function(e){var t=parseInt(e.target.value);B(t),L(60*_+t)},placeholder:"Second"}),Object(u.jsx)("input",{type:"submit",value:"Post",onClick:function(t){t.preventDefault(),function(e,t,n){return fetch("/api/comment",{method:"POST",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({username:e,comment:t,timestamp:n})}).catch((function(){return Promise.reject({error:"network-error"})})).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))}))}(y,M,E).then((function(){console.log("success"),w(""),P(""),L(""),e.fetchComments()})).catch((function(e){console.log("error sending comment")}))},className:"post"})]})]})},d=function(e){return Object(u.jsx)(u.Fragment,{children:Object(u.jsx)("ul",{className:"comments-list",children:e.commentsList?e.commentsList.map((function(e){return Object(u.jsxs)("li",{children:[Object(u.jsxs)("div",{className:"info",children:[Object(u.jsx)("img",{src:e.avatar,alt:"",className:"avatar"}),Object(u.jsxs)("span",{className:"username",children:[e.username," "]}),Object(u.jsx)("span",{className:"at",children:" at "}),Object(u.jsx)("span",{className:"minute",children:Math.floor(e.timestamp/60)}),Object(u.jsx)("span",{children:" : "}),Object(u.jsx)("span",{children:Math.floor(e.timestamp%60)})]}),Object(u.jsx)("p",{children:e.comment})]},e._id)})):null})})},h=function(){var e=Object(c.useState)([]),t=Object(o.a)(e,2),n=t[0],a=t[1];Object(c.useEffect)((function(){s()}),[]);var s=function(){fetch("/api/comments",{method:"GET"}).catch((function(){return Promise.reject({error:"network-error"})})).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))})).then((function(e){a(e)})).catch((function(e){console.log("error getting comment")}))};return Object(u.jsxs)("div",{children:[Object(u.jsx)(f,{fetchComments:s,timelineComments:n.timelineComments}),Object(u.jsx)(d,{commentsList:n.commentsList})]})};var b=function(){return Object(u.jsx)("div",{className:"App",children:Object(u.jsx)(h,{})})},O=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,17)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),c(e),a(e),s(e),r(e)}))};r.a.render(Object(u.jsx)(a.a.StrictMode,{children:Object(u.jsx)(b,{})}),document.getElementById("root")),O()}},[[16,1,2]]]);
//# sourceMappingURL=main.4a7cb6bc.chunk.js.map